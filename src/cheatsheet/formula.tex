\subsection{线性代数}

\subsubsection{行列式}

\begin{equation}
    \operatorname{det}(A):=\sum_{\sigma\in S_n}\prod_{i=1}^n \operatorname{sgn}(\sigma) a_{i,\sigma(i)}
\end{equation}

\subsubsection{积和式}

\begin{equation}
    \operatorname{per}(A):=\sum_{\sigma\in S_n}\prod_{i=1}^n a_{i,\sigma(i)}
\end{equation}

可用于完美匹配中

\paragraph{性质}

\begin{equation}
    \operatorname{per}(A)=\operatorname{haf}\begin{bmatrix}
            & A \\
        A^T & 
    \end{bmatrix}
\end{equation}

\(\operatorname{haf}(A)\) 的定义参见 \fullref{sec:图的完美匹配计数}

\subsection{组合数学}

\subsubsection{组合数相关公式}

\begin{equation}
    \sum_{i=0}^n(-1)^i\binom{n}{i}=[n=0]
\end{equation}

\begin{equation}
    \sum_{i=0}^m \binom{n}{i}\binom{m}{m-i} = \binom{m+n}{m}\qquad(n \geq m)
\end{equation}

\begin{equation}
    \sum_{i=0}^n\binom{n}{i}^2=\binom{2n}{n}
\end{equation}

\begin{equation}
    \sum_{i=0}^ni\binom{n}{i}=n2^{n-1}
\end{equation}

\begin{equation}
    \sum_{i=0}^ni^2\binom{n}{i}=n(n+1)2^{n-2}
\end{equation}

\begin{equation}
    \sum_{i=0}^n\binom{n-i}{i}=F_{n+1}
\end{equation}

其中 \(F\) 是 Fibonacci 数列

\begin{equation}
    g_n = \sum_{i = 0}^{n} \binom{n}{i} f_i \iff f_n = \sum_{i = 0}^{n} \binom{n}{i} (-1)^{n-i} g_i
\end{equation}

\subsubsection{Stirling 数相关公式}

\begin{equation}
    \sum_{n\geq k}\frac{x^n}{n!}\stirlingI{n}{k}=\frac{\left(-\ln(1-x)\right)^k}{k!}
\end{equation}

\begin{equation}
    \sum_{n\geq k}\frac{x^n}{n!}\stirlingII{n}{k}=\frac{\left(\mathrm{e}^x-1\right)^k}{k!}
\end{equation}

\begin{equation}
    \sum_{n\geq k}x^n\stirlingII{n}{k}=\prod_{i=1}^k\frac{x}{1-\mathrm{i}x}
\end{equation}

\begin{equation}
    f_n=\sum_{k=0}^n\stirlingI{n}{k}g_k \iff g_n=\sum_{k=0}^n\stirlingII{n}{k}(-1)^{n-k}f_k
\end{equation}

\begin{equation}
    \stirlingI{n}{k}=\frac{n!}{k!}\frac{k}{n}\left[x^{n-k}\right]\left(\frac{x}{\mathrm{e}^x-1}\right)^n
\end{equation}

\begin{equation}
    \stirlingII{n}{k}=\frac{n!}{k!}\frac{k}{n}\left[x^{n-k}\right]\left(\frac{x}{\ln(1+x)}\right)^n
\end{equation}

注意: \eqref{cs:formula:s-right} 是对的, \fullref{sec:theoretical-computer-science-cheat-sheet} 的第 43 个是错的

\begin{equation}
    \label{cs:formula:s-right}
    \stirlingI{n+m+1}{m}=\sum_{k=0}^m(n+k)\stirlingI{k+n}{k}
\end{equation}

\begin{equation}
    n^{\underline{n-m}}[n\geq m]=\sum_{k=0}^n\stirlingI{n+1}{k+1}\stirlingII{k}{m}(-1)^{m-k}
\end{equation}

\begin{equation}
    \stirlingII{-n+m}{-n}=\sum_k\binom{m-n}{m+k}\binom{m+n}{n+k}\stirlingI{-k}{-k-m}
\end{equation}

\subsubsection{Burnside 引理}

令 \(G\) 为置换群, \(X\) 为一集合, 则

\[
    |X/G|=\frac{1}{|G|}\sum_{g\in G}\left|X^g\right|
\]

其中 \(X^g:=\{x\in X:gx=x\}\) 表示 \(X\) 中关于 \(g\) 的稳定化子

推论(P\'olya 定理):

\[
    \left|Y^X/G\right|=\frac{1}{|G|}\sum_{g\in G} |Y|^{c(g)}
\]

其中 \(c(g)\) 为置换 \(g\) 能拆成的不相交循环置换的数量

推论: 设 \(f(k)\) 为对长为 \(k\) 的序列按固定顺序计数的结果, 此时可令 \(G=\mathbb{Z}_n\), 从而

\[
    g(n)=\frac{1}{n}\sum_{k=0}^{n-1}f(\gcd(n,k))=\frac{1}{n} \{f*\varphi\}(n)
\]

其中 \(*\) 为 Dirichlet 卷积

如: 长为 \(n\) 的项链, 珠子可以染 \(m\) 种颜色, 则总方案数为

\[
    \frac{1}{n}\sum_{k=0}^{n-1} m^{\gcd(n,k)}
\]

\subsection{初等数论}

\subsubsection{Dirichlet 卷积相关公式}

\begin{equation}
    \sum_{i=1}^n\sum_{j=1}^m(i,j)^k=\sum_{D=1}^{\min\{n,m\}}\left\lfloor\frac{n}{D}\right\rfloor\left\lfloor\frac{m}{D}\right\rfloor\{\operatorname{id}_k*\mu\}(D)
\end{equation}

\begin{equation}
    \{\operatorname{id}_k*\mu\}(p^s)=p^{ks}-p^{k(s-1)}
\end{equation}

\subsubsection{升幂引理}

对 \(n>0\), \(p\in\mathbb{P}\), \(x,y\in\mathbf{Z}\), \(p\nmid x,y\) 且 \(p\mid x-y\):

\begin{itemize}
    \item 对奇素数 \(p\) 或满足 \(4\mid x-y\) 的偶素数 \(p\), 有 \(v_p\left(x^n-y^n\right)=v_p(x-y)+v_p(n)\)
    \item \(p=2\) 且 \(2\mid n\), 有 \(v_p\left(x^n-y^n\right)=v_p\left(\left(x^2\right)^{n/2}-\left(y^2\right)^{n/2}\right)\)
\end{itemize}

\subsubsection{Pythagorean 三元组}

\[
    \begin{array}{ccc}
        a=k\cdot\left(m^2-n^2\right)&b=k\cdot\left(2mn\right)&c=k\cdot\left(m^2+n^2\right)
    \end{array}
\]

其中 \(0<n<m\), \(k>0\), \(m\perp n\), 且 \(m\), \(n\) 中恰有一个奇数

\subsection{杂项}

\begin{equation}
    \lfloor x\rfloor=\begin{cases}
        \displaystyle x+\frac{\arctan\cot\pi x}{\pi}-\frac{1}{2}, & x\notin\mathrm{Z} \\
        x,                                                        & x\in\mathrm{Z}
    \end{cases}
\end{equation}

\begin{equation}
    \varphi(xy)=\varphi(x)\varphi(y)\frac{(x,y)}{\varphi((x,y))}
\end{equation}

\begin{equation}
    \mathrm{e}(\mathrm{e}+\pi)^\mathrm{e}(2e + \pi)^\mathrm{e}+\frac{\mathrm{e}}{(\pi^\mathrm{e}-\mathrm{e})(\mathrm{e}+\mathrm{e}^\pi-\pi^\mathrm{e})}\approx 114514.1919810
\end{equation}

\begin{equation}
    \begin{aligned}
        \sum_{i=0}^n(a+di)r^i & =\begin{cases}
                                     na+\dfrac{n(n-1)}{2}d,                                        & r=1    \\
                                     \dfrac{a(1-r^n)-(n-1)r^nd}{1-r}+\dfrac{1-r^{n-1}}{(1-r)^2}rd, & r\ne 1 \\
                                 \end{cases} \\
                              & \to\begin{cases}
                                       \infty,                             & |r|\geq 1 \\
                                       \dfrac{a}{1-r}+\dfrac{rd}{(1-r)^2}, & |r|<1
                                   \end{cases}\qquad(n\to+\infty)
    \end{aligned}
\end{equation}
