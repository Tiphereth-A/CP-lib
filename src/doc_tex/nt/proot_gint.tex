保证结果的实部为 \(1\)

考虑 \(\mathbb{Z}_m\left[\sqrt{k}\right],~k\in\mathbb{Z},\sqrt{k}\notin \mathbb{Z},m\in\mathbb{P}_{>2}\), 我们有

\[
    \left(1+b\sqrt{k}\right)^{m+1}\equiv 1+b^2 k^{(m+1)/2} + b\left(1+k^{(m-1)/2}\right)\sqrt{k} \equiv\begin{cases}
        1-b^2 k,              & \left(\frac{k}{m}\right)=1  \\
        1+b^2 k + 2b\sqrt{k}, & \left(\frac{k}{m}\right)=-1 \\
    \end{cases} \pmod m
\]

若 \(k\) 不是模 \(m\) 的二次剩余, 则 \(\mathbb{Z}_m\left[\sqrt{k}\right]\) 是域.

若 \(k\) 是模 \(m\) 的二次剩余, 设 \(x^2\equiv k\pmod m\), 则 \(\mathbb{Z}_m\left[\sqrt{k}\right]\) 中有零因子 \(x\pm\sqrt{k}\), 从而不是域.

关于扩域 NTT 原根的选取方式, 参考文献 \cite{ieee1451721}, 由 \fullref{sec:原根(gauss-整数)} 部分的讨论, 设素模数 \(m=4k+1,~k\in\mathbb{N}_+\), 我们已知

\[
    \left(1+b\mathrm{i}\right)^{m+1}\equiv 1+b^2\pmod m
\]

此时 \(\mathbb{Z}_m\left[\mathrm{i}\right]\) 是域, 设 \(g\) 为模 \(m\) 的原根, 则 \(\exists x=2l+1,~l\in\mathbb{N}\) 使得

\[
    1+b^2\equiv g^x\pmod m
\]

从而我们想要的原根 \(\omega=\left(1+b\mathrm{i}\right)g^{-(x-1)/2}\)
