对 \(2n\times 2n\) 的对称矩阵 \(A\), 其 Hafnian \(\operatorname{haf}(A)\) 定义为 \(\displaystyle\operatorname{haf}(A):=\frac{1}{n!2^n}\sum_{\sigma\in S_{2n}}\prod_{i=1}^n a_{\sigma(2j-1),\sigma(2j)}\)

其中 \(S_{2n}\) 为 \(2n\) 阶对称群

\paragraph{性质}

\(\operatorname{haf}(A)\) 为以 \(A\) 为邻接矩阵的图的完美匹配数量

\[
    \operatorname{per}(A)=\operatorname{haf}\begin{bmatrix}
            & A \\
        A^T &
    \end{bmatrix}
\]

和 \fullref{sec:矩阵的-pfaffian} 的关系相当于积和式与行列式的关系, 参见 \fullref{ssec:lalg}

\paragraph{输入}

\verb|mat|: \(2n\times 2n\) 对称矩阵

\paragraph{输出}

\verb|mat| 的 Hafnian

\paragraph{复杂度}

\(\mathcal{O}(n^32^n)\)
